<!DOCTYPE html>
<html>
	<title>mustermind v0.2.1 (Beta)</title>
<head>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter|Space+Grotesk">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Import Plotly.js for ScatterPlot-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="Language.js"></script>
<style>
 /* General styling (body) */
 body {
  font-family: "Inter", "Roboto", "Arial"; /* Custom secondary fonts */
  font-weight: lighter;
 }

 h2 {
  font-family: "Space Grotesk", "Roboto", "Arial"; /* Custom primary fonts */
  font-weight: bold;
 }

 details {
  color: gray;
 }

 p {
 font-size:14px;
 }
 
 table {
  align: center;
  width: 100%;
 }

 th {
  color: #fff;
  background-color: black; /* Custom Primary Color (originally: #082471) */
  text-align: center;
  padding: 6px 0px 6px;
  border: 2px solid #fff; /* White */
 }
 
 .tablesection {
   font-weight: bold;
 }

 /* Head bar styling */
 .headbar {
   height: 80px;
   width: 100%;
   left: 0;
   top: 0;
   z-index: 1;
   position: fixed;
   font-family: "Space Grotesk", "Roboto", "Arial"; /* Custom primary fonts */
   font-size: xx-large;
   font-weight: bolder;
   color: #fff; /* White */
   background-color: #000000; /* Custom Primary Color */
   padding: 0px 20px;
 }

/* Language Dropdown Styling */
 .language {
   background-color: #000000; /* Custom Primary Color */
   color:#fff; /* White */
 }

/* Side navigation styling */
.sidenav {
  height: 100%;
  width: 200px;
  position: fixed;
  z-index: 1;
  top: 80;
  left: 0;
  font-family: "Inter", "Roboto", "Arial"; /* Custom primary fonts */
  background-color: #f1f1f1; /* Shade of Gray */
  overflow-x: hidden;
}

/* Side navigation buttons */
.sidenav button {
  display: block;
  background-color: inherit;
  color: black;
  font-family: "Inter", "Roboto", "Arial"; /* Custom primary fonts */
  padding: 22px 16px;
  width: 100%;
  border: none;
  outline: none;
  text-align: left;
  cursor: pointer;
  transition: 0.3s;
  font-size: 17px;
}

.sidenav button:hover {
  background-color: #ddd; /* Shade of Gray */
}

.sidenav button.active {
  background-color: #ccc; /* Shade of Gray */
  font-family: "Inter", "Roboto", "Arial"; /* Custom primary fonts */
  font-weight: bold;
}

/* Tab content styling */
.tabcontent {
  margin-left: 200px;
  margin-top: 80px;
  padding: 15px 20px;
}

/* Standard button styling */
button {
  background-color: #000000; /* Custom Secondary Color (originally #f7475c) */
  border: none;
  font-family: "Space Grotesk", "Inter", "Roboto", "Arial";
  color: white; /* White */
  padding: 10px 20px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin: 4px 2px;
  cursor: pointer;
 }

 /* Loader styling */
#loader {
  border: 12px solid #f3f3f3; /* Shade of Gray */
  border-radius: 50%;
  border-top: 12px solid #082471; /* Custom Primary Color */
  width: 40px;
  height: 40px;
  -webkit-animation: spin 2s linear infinite; /* Safari */
  animation: spin 2s linear infinite;
}
/* Safari */
@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

 /* iframe styling */
 iframe {
  display:block;
 }

</style>
</head>
<body onload="ChangeLanguage()">

<!-- Head Bar -->
<div class="headbar">
  <img src="mui-logo.jpg" alt="logo" height=60>
  Mustermind Intelligence Platform (Legacy)
  <select class="language" onchange="ChangeLanguage()" id="Language" style="float:right; margin-right: 40px; margin-top:30px;">
    <option value="0">EN</option>
    <option value="1">TR</option>
  </select>
</div>

<!-- New side navigation bar -->
<div class="sidenav">
  <button class="tablinks" onclick="openSection(event, 'LegacyParts')" id="text7"><i class="fa-solid fa-cube"></i></button>
  <button class="tablinks" onclick="openSection(event, 'NewPart')" id="text8"></button>
  <button class="tablinks" onclick="openSection(event, 'Visualization')"id="text9"></button>
  <button class="tablinks" onclick="openSection(event, 'MoldingSheet')" id="text10"></button>
  <button class="tablinks" onclick="openSection(event, 'Preview')" id="text11"></button>
  <button class="tablinks" onclick="openSection(event, 'Feedback')" id="text12"></button>
</div>

<!-- Main application / tab contents -->

<div id="LegacyParts" class="tabcontent">
  <h2 id="text1"></h2>
  <details>
    <summary><span id="text13"></span></summary>
  <p id="text18"></p></details><br>
  <!-- CSV Creation Table -->
  <table id="legacy">
    <tr>
      <th style="background-color: #fff"></th>
      <th id="text29"></th>
      <th id="text30"></th>
      <th id="text31"></th>
      <th id="text32"></th>
      <th id="text33"></th>
    </tr>
    <!-- Part and mold design -->
    <tr><td class="tablesection" id="text34"></td></tr>
    <!-- Min. Wall Thicknesses -->
    <tr>
      <td id="text35"></td>
      <td><input type="number" id="wt_min1" min=0 style="width: 6em;" value=0.6></td>
      <td><input type="number" id="wt_min2" min=0 style="width: 6em;" value=0.6></td>
      <td><input type="number" id="wt_min3" min=0 style="width: 6em;" value=0.75></td>
      <td><input type="number" id="wt_min4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="wt_min5" min=0 style="width: 6em;"></td>
    </tr>
    <!-- Avg. Wall Thicknesses -->
    <tr>
      <td id="text36"></td>
      <td><input type="number" id="wt_avg1" min=0 style="width: 6em;" value=2></td>
      <td><input type="number" id="wt_avg2" min=0 style="width: 6em;" value=1.7></td>
      <td><input type="number" id="wt_avg3" min=0 style="width: 6em;" value=1.8></td>
      <td><input type="number" id="wt_avg4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="wt_avg5" min=0 style="width: 6em;"></td>
  </tr>
  <!-- Max. Wall Thickness -->
  <tr>
    <td id="text37"></td>
      <td><input type="number" id="wt_max1" min=0 style="width: 6em;" value=4></td>
      <td><input type="number" id="wt_max2" min=0 style="width: 6em;" value=4></td>
      <td><input type="number" id="wt_max3" min=0 style="width: 6em;" value=4.4></td>
      <td><input type="number" id="wt_max4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="wt_max5" min=0 style="width: 6em;"></td>
  </tr>
  <!-- Projected Area -->
  <tr>
    <td id="text38"></td>
      <td><input type="number" id="A_proj1" min=0 style="width: 6em;" value=43715></td>
      <td><input type="number" id="A_proj2" min=0 style="width: 6em;" value=37012></td> 
      <td><input type="number" id="A_proj3" min=0 style="width: 6em;" value=39330></td>
      <td><input type="number" id="A_proj4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="A_proj5" min=0 style="width: 6em;"></td>
  </tr>
  <!-- Volume -->
  <tr>
    <td id="text39"></td>
      <td><input type="number" id="vol1" min=0 style="width: 6em;" value=105.4></td>
      <td><input type="number" id="vol2" min=0 style="width: 6em;" value=88.96></td> 
      <td><input type="number" id="vol3" min=0 style="width: 6em;" value=102.45></td>
      <td><input type="number" id="vol4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="vol5" min=0 style="width: 6em;"></td>
  </tr>
  <!-- No. of gates -->
  <tr>
    <td id="text40"></td>
      <td><input type="number" id="no_gate1" min=0 style="width: 6em;" value=1></td>
      <td><input type="number" id="no_gate2" min=0 style="width: 6em;" value=2></td> 
      <td><input type="number" id="no_gate3" min=0 style="width: 6em;" value=2></td>
      <td><input type="number" id="no_gate4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="no_gate5" min=0 style="width: 6em;"></td>
  </tr>
  <!-- Max Flow length -->
  <tr>
    <td id="text41"></td>
      <td><input type="number" id="l_flow1" min=0 style="width: 6em;" value=240></td>
      <td><input type="number" id="l_flow2" min=0 style="width: 6em;" value=120></td> 
      <td><input type="number" id="l_flow3" min=0 style="width: 6em;" value=140></td>
      <td><input type="number" id="l_flow4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="l_flow5" min=0 style="width: 6em;"></td>
  </tr>
  <!-- Gate diameter -->
  <tr>
    <td id="text42"></td>
      <td><input type="number" id="d_gate1" min=0 style="width: 6em;" value=1.2></td>
      <td><input type="number" id="d_gate2" min=0 style="width: 6em;" value=0.8></td> 
      <td><input type="number" id="d_gate3" min=0 style="width: 6em;" value=1.3></td>
      <td><input type="number" id="d_gate4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="d_gate5" min=0 style="width: 6em;"></td>
  </tr>
  <!-- Material data section -->
  <tr><td class="tablesection" id="text43"></td></tr>
  <!-- Material type -->
  <tr>
    <td id="text44"></td>
    <td><select id="mat1" style="width: 6em;">
      <option value="ABS">ABS</option>
      <option value="PP">PP</option>
      <option value="PE-LD">PE-LD</option>
      <option value="PE-HD">PE-HD</option>
      <option value="PS">PS</option>
      <option value="SAN">SAN</option>
      <option value="PVC">PVC</option>
      <option value="PMMA">PMMA</option>
      <option value="PC">PC</option>
      <option value="PET">PET</option>
      <option value="PBT">PBT</option>
      <option value="POM">POM</option>
      <option value="PA6">PA6</option>
      <option value="PA66">PA66</option>
      <option value="PA12">PA12</option>
      <option value="other">Other</option>
    </select></td>
    <td><select id="mat2" style="width: 6em;">
      <option value="ABS">ABS</option>
      <option value="PP">PP</option>
      <option value="PE-LD">PE-LD</option>
      <option value="PE-HD">PE-HD</option>
      <option value="PS">PS</option>
      <option value="SAN">SAN</option>
      <option value="PVC">PVC</option>
      <option value="PMMA">PMMA</option>
      <option value="PC">PC</option>
      <option value="PET">PET</option>
      <option value="PBT">PBT</option>
      <option value="POM">POM</option>
      <option value="PA6">PA6</option>
      <option value="PA66">PA66</option>
      <option value="PA12">PA12</option>
      <option value="other">Other</option>
    </select></td>
    <td><select id="mat3" style="width: 6em;">
      <option value="ABS">ABS</option>
      <option value="PP">PP</option>
      <option value="PE-LD">PE-LD</option>
      <option value="PE-HD">PE-HD</option>
      <option value="PS">PS</option>
      <option value="SAN">SAN</option>
      <option value="PVC">PVC</option>
      <option value="PMMA">PMMA</option>
      <option value="PC">PC</option>
      <option value="PET">PET</option>
      <option value="PBT">PBT</option>
      <option value="POM">POM</option>
      <option value="PA6">PA6</option>
      <option value="PA66">PA66</option>
      <option value="PA12">PA12</option>
      <option value="other">Other</option>
    </select></td>
    <td><select id="mat4" style="width: 6em;">
      <option value="-"> </option>
      <option value="PP">PP</option>
      <option value="PE-LD">PE-LD</option>
      <option value="PE-HD">PE-HD</option>
      <option value="ABS">ABS</option>
      <option value="PS">PS</option>
      <option value="SAN">SAN</option>
      <option value="PVC">PVC</option>
      <option value="PMMA">PMMA</option>
      <option value="PC">PC</option>
      <option value="PET">PET</option>
      <option value="PBT">PBT</option>
      <option value="POM">POM</option>
      <option value="PA6">PA6</option>
      <option value="PA66">PA66</option>
      <option value="PA12">PA12</option>
      <option value="other">Other</option>
    </select></td>
    <td><select id="mat5" style="width: 6em;">
      <option value="-"> </option>
      <option value="PP">PP</option>
      <option value="PE-LD">PE-LD</option>
      <option value="PE-HD">PE-HD</option>
      <option value="ABS">ABS</option>
      <option value="PS">PS</option>
      <option value="SAN">SAN</option>
      <option value="PVC">PVC</option>
      <option value="PMMA">PMMA</option>
      <option value="PC">PC</option>
      <option value="PET">PET</option>
      <option value="PBT">PBT</option>
      <option value="POM">POM</option>
      <option value="PA6">PA6</option>
      <option value="PA66">PA66</option>
      <option value="PA12">PA12</option>
      <option value="other">Other</option>
    </select></td>
  </tr>
  <!-- MFR -->
  <tr>
    <td id="text45"></td>
      <td><input type="number" id="mfr1" min=0 style="width: 6em;" value=20></td>
      <td><input type="number" id="mfr2" min=0 style="width: 6em;" value=21></td> 
      <td><input type="number" id="mfr3" min=0 style="width: 6em;" value=23></td>
      <td><input type="number" id="mfr4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="mfr5" min=0 style="width: 6em;"></td>
  </tr>
  <!-- Fiber -->
  <tr>
    <td id="text46"></td>
      <td><input type="number" id="fib1" min=0 step=5 style="width: 6em;" value=0></td>
      <td><input type="number" id="fib2" min=0 step=5 style="width: 6em;" value=0></td> 
      <td><input type="number" id="fib3" min=0 step=5 style="width: 6em;" value=0></td>
      <td><input type="number" id="fib4" min=0 step=5 style="width: 6em;"></td>
      <td><input type="number" id="fib5" min=0 step=5 style="width: 6em;"></td>
  </tr>
  <!-- Process data section -->
  <tr><td class="tablesection" id="text47"></td></tr>
  <!-- Injection time -->
  <tr>
    <td id="text48"></td>
      <td><input type="number" id="t_inj1" min=0 style="width: 6em;"></td>
      <td><input type="number" id="t_inj2" min=0 style="width: 6em;"></td> 
      <td><input type="number" id="t_inj3" min=0 style="width: 6em;"></td>
      <td><input type="number" id="t_inj4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="t_inj5" min=0 style="width: 6em;"></td>
  </tr>
  <!-- Melt temperature -->
  <tr>
    <td id="text49"></td>
      <td><input type="number" id="T_melt1" min=0 style="width: 6em;"></td>
      <td><input type="number" id="T_melt2" min=0 style="width: 6em;"></td> 
      <td><input type="number" id="T_melt3" min=0 style="width: 6em;"></td>
      <td><input type="number" id="T_melt4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="T_melt5" min=0 style="width: 6em;"></td>
  </tr>
  <!-- Mold temperature -->
  <tr>
    <td id="text50"></td>
      <td><input type="number" id="T_mold1" min=0 style="width: 6em;"></td>
      <td><input type="number" id="T_mold2" min=0 style="width: 6em;"></td> 
      <td><input type="number" id="T_mold3" min=0 style="width: 6em;"></td>
      <td><input type="number" id="T_mold4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="T_mold5" min=0 style="width: 6em;"></td>
  </tr>
  <!-- Clamp force -->
  <tr>
    <td id="text51"></td>
      <td><input type="number" id="F_clamp1" min=0 style="width: 6em;"></td>
      <td><input type="number" id="F_clamp2" min=0 style="width: 6em;"></td> 
      <td><input type="number" id="F_clamp3" min=0 style="width: 6em;"></td>
      <td><input type="number" id="F_clamp4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="F_clamp5" min=0 style="width: 6em;"></td>
  </tr>

  <!-- Injection pressure -->
  <tr>
    <td id="text52"></td>
      <td><input type="number" id="p_inj1" min=0 style="width: 6em;"></td>
      <td><input type="number" id="p_inj2" min=0 style="width: 6em;"></td> 
      <td><input type="number" id="p_inj3" min=0 style="width: 6em;"></td>
      <td><input type="number" id="p_inj4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="p_inj5" min=0 style="width: 6em;"></td>
  </tr>
  <!-- Packing Pressure -->
  <tr>
    <td id="text53"></td>
      <td><input type="number" id="p_pack1" min=0 style="width: 6em;"></td>
      <td><input type="number" id="p_pack2" min=0 style="width: 6em;"></td> 
      <td><input type="number" id="p_pack3" min=0 style="width: 6em;"></td>
      <td><input type="number" id="p_pack4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="p_pack5" min=0 style="width: 6em;"></td>
  </tr>
  <!-- Packing time -->
  <tr>
    <td id="text54"></td>
      <td><input type="number" id="t_pack1" min=0 style="width: 6em;"></td>
      <td><input type="number" id="t_pack2" min=0 style="width: 6em;"></td> 
      <td><input type="number" id="t_pack3" min=0 style="width: 6em;"></td>
      <td><input type="number" id="t_pack4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="t_pack5" min=0 style="width: 6em;"></td>
  </tr>
  <!-- Cooling time -->
  <tr>
    <td id="text55"></td>
      <td><input type="number" id="t_cool1" min=0 style="width: 6em;"></td>
      <td><input type="number" id="t_cool2" min=0 style="width: 6em;"></td> 
      <td><input type="number" id="t_cool3" min=0 style="width: 6em;"></td>
      <td><input type="number" id="t_cool4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="t_cool5" min=0 style="width: 6em;"></td>
  </tr>
  <!-- Rest cycle time -->
  <tr>
    <td id="text56"></td>
      <td><input type="number" id="t_cycle1" min=0 style="width: 6em;"></td>
      <td><input type="number" id="t_cycle2" min=0 style="width: 6em;"></td> 
      <td><input type="number" id="t_cycle3" min=0 style="width: 6em;"></td>
      <td><input type="number" id="t_cycle4" min=0 style="width: 6em;"></td>
      <td><input type="number" id="t_cycle5" min=0 style="width: 6em;"></td>
  </tr>
</table>
<br>
<!-- Create CSV Buttons -->
<button onclick="NewCSV()"><span id="text25"></span></button><br><br>
</div>

<div id="NewPart" class="tabcontent">
  <h2 id="text2"></h2>
  <details><summary><span id="text14"></span></summary>
  <p id="text19"></p></details><br>
  <!-- Input for new part -->
  <label id="text57"></label><br><input type="number" min=0 id="wt_min_new"><br><br>
  <label id="text58"></label><br><input type="number" min=0 id="wt_avg_new"><br><br>
  <label id="text59"></label><br><input type="number" min=0 id="wt_max_new"><br><br>
  <label id="text60"></label><br><input type="number" min=0 id="A_proj_new"><br><br>
  <label id="text61"></label><br><input type="number" min=0 id="vol_new"><br><br>
  <label id="text62"></label><br><input type="number" min=0 id="no_gate_new"><br><br>
  <label id="text63"></label><br><input type="number" min=0 id="l_flow_new"><br><br>
  <label id="text64"></label><br><input type="number" min=0 id="d_gate_new"><br><br>
  <label id="text65"></label><br><select id="mat_new">
      <option value="-"> </option>
      <option value="PP">PP</option>
      <option value="PE-LD">PE-LD</option>
      <option value="PE-HD">PE-HD</option>
      <option value="ABS">ABS</option>
      <option value="PS">PS</option>
      <option value="SAN">SAN</option>
      <option value="PVC">PVC</option>
      <option value="PMMA">PMMA</option>
      <option value="PC">PC</option>
      <option value="PET">PET</option>
      <option value="PBT">PBT</option>
      <option value="POM">POM</option>
      <option value="PA6">PA6</option>
      <option value="PA66">PA66</option>
      <option value="PA12">PA12</option>
      <option value="other">Other</option>
    </select><br><br>
  <label id="text66"></label><br><input type="number" min=0 id="mfr_new"><br><br>
  <label id="text67"></label><br><input type="number" id="fib_new" min=0 step=5><br><br>
  <button onclick="UserInput()"><span id="text26"></span></button><br><br>
</div>

<div id="Visualization" class="tabcontent">
  <h2 id="text3"></h2>
  <details><summary><span id="text15"></span></summary>
  <p id="text20"></p><p id="text21"></p></details><br>
  <!-- Create Plot -->
  <button type="button" onclick="PlotParts()"><span id="text27"></span></button><br><br>
  <!-- Spaceholder (div) for Plot -->
  <div id="PartScatterPlot"></div>
</div>

<div id="MoldingSheet" class="tabcontent">
  <h2 id="text4"></h2>
  <details><summary><span id="text16"></span></summary>
  <p id="text22"></p><p id="text23"></p></details><br>
  <!-- Hide send confirmation with hidden iframe-->
  <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;" width="0" height="0" tabindex="-1" title="empty"></iframe>
  <!-- Forward order form to Google Cloud Platform / Drive -->
  <form action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSfxMxivKFrdoYViSsfzcv2Mb3JXdVl0am56-zX1mBHKnkiCjw/formResponse" method="post" target="hidden_iframe";>
    <!-- order form content-->
    <label id="text68"></label><br><input type="email" required size=24 name="entry.1612017441"><br>
    <label id="text69"></label><br><input type="password" required size=24 name="entry.1379137992"><br>
    <label id="text70"></label><br><textarea id="CSV" rows="20" cols="25" required name="entry.1042882814"></textarea><br>
    <label id="text71"></label><br><input type="text" size=24 id="InputCSV" required name="entry.1032610544"><br>
    <label id="text72"></label><br><select required name="entry.1226274396"><option value="ENG">ENG</option><option value="DE">DE</option><option value="TR">TR</option></select><br><br>
    <input type="checkbox" required id="agreement" name="agreement" value="agreement">
    <label for="agreement"><span id="text73"></span> <a href="https://mustermind.de/terms" target="_blank" id="text74"></a> <span id="text76"></span> <a href="https://mustermind.de/privacy-policy" target="_blank" id="text75"></a></label><br>
    <br><button type="submit" onclick="Preview()"><span id="text28"></span></button>
  </form>
</div>

<div id="Preview" class="tabcontent">
  <h2 id="text5"></h2>
  <details><summary><span id="text17"></span></summary>
  <p id="text24"></p></details><br>
  <!-- iframe for Preview -->
  <div id="loader" style="display:none;"></div>
  <div id="Preview"></div>
</div>

<div id="Feedback" class="tabcontent">
  <h2 id="text6"></h2>	
  <p><span id="text77"></span> <a href="https://mustermind.convas.io/" target="_blank" id="text78"></a> <span id="text79"></span></p>
</div>
<script>

// Tab selection
function openSection(evt, sectionName) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(sectionName).style.display = "block";
  evt.currentTarget.className += " active";
}
document.getElementById("text7").click();

// Create CSV
function NewCSV() {
    wt_minArr = [];
    wt_avgArr = [];
	wt_maxArr = [];
    A_projArr = [];
    volArr = [];
    no_gateArr = [];
    l_flowArr = [];
    d_gateArr = [];
    mfrArr = [];
    t_injArr = [];
    T_meltArr = [];
    T_moldArr = [];
    F_clampArr = [];
    p_injArr = [];
    p_packArr = [];
    t_packArr = [];
    t_coolArr = [];
    t_cycleArr = [];
    mat_Arr = [];
    fib_Arr = [];
    for (var i = 0; i < 5; i++) {
    wt_minArr[i] = Math.round(document.getElementById('wt_min'+(i+1)).value*100);
    wt_avgArr[i] = Math.round(document.getElementById('wt_avg'+(i+1)).value*100);
    wt_maxArr[i] = Math.round(document.getElementById('wt_max'+(i+1)).value*100);
    A_projArr[i] = Math.round(document.getElementById('A_proj'+(i+1)).value*100);
    volArr[i] = Math.round(document.getElementById('vol'+(i+1)).value*100);
    no_gateArr[i] = Math.round(document.getElementById('no_gate'+(i+1)).value*100);
    l_flowArr[i] = Math.round(document.getElementById('l_flow'+(i+1)).value*100);
    d_gateArr[i] = Math.round(document.getElementById('d_gate'+(i+1)).value*100);
    mfrArr[i] = Math.round(document.getElementById('mfr'+(i+1)).value*100);
    t_injArr[i] = Math.round(document.getElementById('t_inj'+(i+1)).value*100);
    T_meltArr[i] = Math.round(document.getElementById('T_melt'+(i+1)).value*100);
    T_moldArr[i] = Math.round(document.getElementById('T_mold'+(i+1)).value*100);
    F_clampArr[i] = Math.round(document.getElementById('F_clamp'+(i+1)).value*100);
    p_injArr[i] = Math.round(document.getElementById('p_inj'+(i+1)).value*100);
	p_packArr[i] = Math.round(document.getElementById('p_pack'+(i+1)).value*100);
	t_packArr[i] = Math.round(document.getElementById('t_pack'+(i+1)).value*100);
	t_coolArr[i] = Math.round(document.getElementById('t_cool'+(i+1)).value*100);
	t_cycleArr[i] = Math.round(document.getElementById('t_cycle'+(i+1)).value*100);
    mat_Arr[i] = document.getElementById('mat'+(i+1)).value;
    fib_Arr[i] = Math.round(document.getElementById('fib'+(i+1)).value*100);
    };
	document.getElementById("CSV").innerHTML =
    	wt_minArr + ";" + "\n" +
        wt_avgArr + ";" + "\n" +
        wt_maxArr + ";" + "\n" +
        A_projArr + ";" + "\n" +
        volArr + ";" + "\n" +
        no_gateArr + ";" + "\n" +
        l_flowArr + ";" + "\n" +
        d_gateArr + ";" + "\n" +
        mfrArr + ";" + "\n" +        
        t_injArr + ";" + "\n" +
    	T_meltArr + ";" + "\n" +
    	T_moldArr + ";" + "\n" +
		F_clampArr + ";" + "\n" +
		p_injArr + ";" + "\n" +
		p_packArr + ";" + "\n" +
		t_packArr + ";" + "\n" +
		t_coolArr + ";" + "\n" +
		t_cycleArr + ";" + "\n" +
        mat_Arr + ";" + "\n" +
        fib_Arr + ";";
}

// Plot created CSV
function PlotParts() {
    wt_avgArr = [];
    volArr = [];
    l_flowArr = [];
    for (var i = 0; i < 5; i++) {
    wt_avgArr[i] = document.getElementById('wt_avg'+(i+1)).value*100;
    volArr[i] = document.getElementById('vol'+(i+1)).value*100;
    l_flowArr[i] = document.getElementById('l_flow'+(i+1)).value*100;
    };
    wt_newPlot = document.getElementById('wt_avg_new').value*100;
    vol_newPlot = document.getElementById('vol_new').value*100;
    lflow_newPlot = document.getElementById('l_flow_new').value*100;

  /* Part traces (no for loops due to different color shades) */
  var part1 = {
    x : [wt_avgArr[0]],
    y: [volArr[0]],
    z : [l_flowArr[0]],
    mode: 'markers',
    marker: {
      size: 12,
       color: 'rgb(0, 0, 0)',
      line: {
        color: 'rgba(0, 0, 0, 0.8)',
        width: 0.7
      },
      opacity: 0.8
    },
    type: 'scatter3d',
    name: 'Part 1'
  };

  var part2 = {
    x : [wt_avgArr[1]],
    y: [volArr[1]],
    z : [l_flowArr[1]],
    mode: 'markers',
    marker: {
      size: 12,
      color: 'rgb(0, 0, 0)',
      line: {
        color: 'rgba(0, 0, 0, 0.8)',
        width: 0.7
      },
      opacity: 0.8
    },
    type: 'scatter3d',
    name: 'Part 2'
  };

  var part3 = {
    x : [wt_avgArr[2]],
    y: [volArr[2]],
    z : [l_flowArr[2]],
    mode: 'markers',
    marker: {
      size: 12,
      color: 'rgb(0, 0, 0)',
      line: {
        color: 'rgba(0, 0, 0, 0.8)',
        width: 0.7
      },
       mode : 'markers',
      opacity: 0.8
    },
    type: 'scatter3d',
    name: 'Part 3'
  };

  var part4 = {
    x : [wt_avgArr[3]],
    y: [volArr[3]],
    z : [l_flowArr[3]],
    mode: 'markers',
    marker: {
      size: 12,
      color: 'rgb(0, 0, 0)',
      line: {
        color: 'rgba(0, 0, 0, 0.8)',
        width: 0.7
      },
      opacity: 0.8
    },
    type: 'scatter3d',
    name: 'Part 4'
  };

  var part5 = {
    x : [wt_avgArr[4]],
    y: [volArr[4]],
    z : [l_flowArr[4]],
    mode: 'markers',
    marker: {
      size: 12,
      color: 'rgb(0, 0, 0)',
      line: {
        color: 'rgba(0, 0, 0, 0.8)',
        width: 0.7
      },
      opacity: 0.8
    },
    type: 'scatter3d',
    name: 'Part 5'
  };
  
    var newpart = {
    x : [wt_newPlot],
    y: [vol_newPlot],
    z : [lflow_newPlot],
    mode: 'markers',
    marker: {
      size: 12,
      color: 'rgb(255, 255, 255)',
      line: {
        color: 'rgba(0, 0, 0, 0.8)',
        width: 1
      },
      opacity: 0.8
    },
    type: 'scatter3d',
    name: 'New Part'
  };


  /* Definition of data (parts), layout to use for plotting */
  var parts = [part1, part2, part3, part4, part5, newpart];
  var layout = {
      scene: {
          xaxis:{title: 'Avg. wall thickness (x)'},
          yaxis:{title: 'Volume (y)'},
          zaxis:{title: 'Max. flow length (z)'},
          },
      autosize: true,
      margin: {
       l: 0,
       r: 0,
       b: 0,
       t: 0,
       pad: 15
      },
  }
	Plotly.newPlot('PartScatterPlot', parts, layout);
}


// Create user input csv
function UserInput() {
	var wt_min_new = Math.round(document.getElementById("wt_min_new").value*100);
	var wt_avg_new = Math.round(document.getElementById("wt_avg_new").value*100);
	var wt_max_new = Math.round(document.getElementById("wt_max_new").value*100);
	var A_proj_new = Math.round(document.getElementById("A_proj_new").value*100);
	var vol_new = Math.round(document.getElementById("vol_new").value*100);
	var no_gate_new = Math.round(document.getElementById("no_gate_new").value*100);
	var l_flow_new = Math.round(document.getElementById("l_flow_new").value*100);
	var d_gate_new = Math.round(document.getElementById("d_gate_new").value*100);
    var mfr_new = Math.round(document.getElementById("mfr_new").value*100);
    var mat_new = document.getElementById("mat_new").value;
    var fib_new = Math.round(document.getElementById("fib_new").value*100);

	var InputCSV = wt_min_new + "," + wt_avg_new + "," + wt_max_new + "," + A_proj_new + "," + vol_new + "," + no_gate_new + "," + l_flow_new + "," + d_gate_new + "," + mfr_new + "," + mat_new + "," + fib_new;
	document.getElementById("InputCSV").value = InputCSV;
}

// Preview
function Preview() {
    document.getElementById("loader").style.display = "block";
    setTimeout(showPreview, 300000);
}

function showPreview() {
  document.getElementById("loader").style.display = "none";
  document.getElementById("Preview").innerHTML = "<iframe src=\"https://docs.google.com/spreadsheets/d/e/2PACX-1vRn8XAgv1ZTTB1eh07puzoBMr4lk4VCSOuMh_FpwIon5jN5qf4WOM_qnQxZENSEr85dIPtveol9_GLS/pubhtml?gid=758284375&&headers=false&chrome=false&widget=false&range=B1:G44\" width=\"600\" height=\"1080\" frameborder=\"0\"></iframe>";
}

</script>
</body>
</html>
